from io.hevo.api import Event
import uuid


def map_status(s):
    if not s:
        return "order_unknown"

    s = str(s).strip().lower()

    status_map = {
        "placed": "order_placed",
        "shipped": "order_shipped",
        "delivered": "order_delivered",
        "cancelled": "order_cancelled"
    }

    return status_map.get(s, "order_unknown")

def transform(event):

    props=ev.getProperties() or {}

    order_id = props.get("id")
    customer_id = props.get("customer_id")
    status = props.get("status")

    new_props = {
        "order_id": order_id,
        "customer_id": customer_id,
        "event_type": map_status(status),

    }

    new_event = Event("order_events", new_props)

    return [new_event]
